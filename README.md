# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ —Å–º–µ–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–∑ SQLite –≤ Excel —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –æ—Ç Vostok group

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ **C#**, –∫–æ—Ç–æ—Ä–æ–µ **–ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ Excel-—Ñ–∞–π–ª–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ**, –ø–æ–¥—Å—Ç–∞–≤–ª—è—è —Ç—É–¥–∞ —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö **—Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –Ω–∞ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É**. –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Äî –±–∞–∑–∞ SQLite (`work_schedule.db`).

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω **Web API –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã** –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ HTTP-–∑–∞–ø—Ä–æ—Å.

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- –Ø–∑—ã–∫: **C#**
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: **SQLite (`System.Data.SQLite`)**
- –†–∞–±–æ—Ç–∞ —Å Excel: **ClosedXML**
- –í–µ–±-–∞–ø–∏: **ASP.NET Core + EF Core + Swagger**
- CI/CD: **GitHub Actions**
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è: **Docker + Docker Compose**
- –î–µ–ø–ª–æ–π: **AWS**
- Proxy server: **Nginx**

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å `work_schedule.db`, `ConsoleApp1.exe`, `excel.xlsx` –∏ `run.bat` –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ.
2. **–ó–∞–ø—É—Å–∫**:
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ `run.bat`
   - –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è `ConsoleApp1.exe`, –æ–±–Ω–æ–≤–ª—è—é—â–µ–µ Excel –ø–æ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–µ.
   - –ó–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–µ—Ç—Å—è Excel-—Ñ–∞–π–ª.
3. **–í–∞–∂–Ω–æ:** –î–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ .NET 9 –∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–æ –≤ –≤–∏–¥–µ self-contained –∏ single-file. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã, –∏ –æ–Ω–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å "–∏–∑ –∫–æ—Ä–æ–±–∫–∏".

### –ü–æ—á–µ–º—É `.bat`, –∞ –Ω–µ VBA?

–•–æ—Ç—è –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª–æ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VBA-—Å–∫—Ä–∏–ø—Ç:

```vba
Private Sub Workbook_Open()
    Dim exePath As String
    Dim folderPath As String

    folderPath = ThisWorkbook.Path
    exePath = folderPath & "\ConsoleApp1.exe"

    Shell exePath, vbNormalFocus
End Sub
```
...–≤ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —ç—Ç–æ—Ç —Å–ø–æ—Å–æ–± –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª –∏–∑-–∑–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Microsoft Excel. –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º Excel –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö .exe —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ VBA –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—á–∏–Ω–∞–º:

- –ó–∞–ø—É—Å–∫ .exe –∏–∑ VBA —Ä–∞—Å—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

- –¢—Ä–µ–±—É—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å.

- –£ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π VBA –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á—ë–Ω –≥—Ä—É–ø–ø–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –±–æ–ª–µ–µ –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–±: –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ .bat —Ñ–∞–π–ª (run.bat), –∫–æ—Ç–æ—Ä—ã–π —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç ConsoleApp1.exe, –æ–±–Ω–æ–≤–ª—è—é—â–∏–π Excel, –∞ –∑–∞—Ç–µ–º –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–∞–º Excel-—Ñ–∞–π–ª. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏—è –º–∞–∫—Ä–æ—Å–æ–≤ –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Excel.

---

## –ó–∞–ø—É—Å–∫ Web API (–ë–æ–Ω—É—Å —Ç–∞—Å–∫)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω Web API, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ **–≤—Ä—É—á–Ω—É—é –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É** –∏ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–º–µ–Ω.

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker:

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker compose up --build
```

–≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞.

–ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ –æ–±—Ä–∞–∑ —Å Docker Hub:

```bash
docker pull sleepysleepy8467/test:latest
docker run -p 5000:80 \
  -e ASPNETCORE_ENVIRONMENT=Docker \
  -e ASPNETCORE_URLS=http://+:80 \
  -v ./work_schedule.db:/app/work_schedule.db \
  sleepysleepy8467/test:latest
```

**–í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ:** —Ñ–∞–π–ª **work_schedule.db** –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –æ—Ç–∫—É–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `docker run`. –≠—Ç–æ—Ç —Ñ–∞–π–ª –±—É–¥–µ—Ç –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ –ø—É—Ç–∏ `/app/work_schedule.db`.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –Ω–∞ —Ö–æ—Å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, —á—Ç–æ–±—ã Docker –º–æ–≥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –µ–≥–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å.

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ Swagger:  
[http://localhost:5000/swagger](http://localhost:5000/swagger)

–ú–µ—Ç–æ–¥:  
```
GET /api/Report/GetEmployeeShiftReport?date=2025-04-07
```

> –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã: `–ì–ì–ì–ì-–ú–ú-–î–î` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `2025-04-07`)

–ó–∞–¥–µ–ø–ª–æ–µ–Ω–Ω–∞—è –≤ AWS –≤–µ—Ä—Å–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ —Å—Å—ã–ª–∫–µ:
**[http://16.170.143.184/swagger/index.html](http://16.170.143.184/swagger/index.html)**

### üìã CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏

–í Web API –¥–æ—Å—Ç—É–ø–Ω—ã CRUD-–º–µ—Ç–æ–¥—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –∏–∑ `work_schedule.db`:

#### –¢–∞–±–ª–∏—Ü–∞ `employees`

| –ü–æ–ª–µ         | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö   | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|--------------|--------------|---------------------------|
| id           | INTEGER      | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ |
| first_name   | TEXT         | –ò–º—è                      |
| last_name    | TEXT         | –§–∞–º–∏–ª–∏—è                  |
| profession   | TEXT         | –î–æ–ª–∂–Ω–æ—Å—Ç—å                |
| department   | TEXT         | –û—Ç–¥–µ–ª                    |
| birth_date   | TEXT (DATE)  | –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è            |
| address      | TEXT         | –î–æ–º–∞—à–Ω–∏–π –∞–¥—Ä–µ—Å           |

#### –¢–∞–±–ª–∏—Ü–∞ `shifts`

| –ü–æ–ª–µ         | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö   | –û–ø–∏—Å–∞–Ω–∏–µ                               |
|--------------|--------------|----------------------------------------|
| id           | INTEGER      | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–ø–∏—Å–∏                   |
| employee_id  | INTEGER      | –°—Å—ã–ª–∫–∞ –Ω–∞ `employees.id`               |
| shift_date   | TEXT (DATE)  | –î–∞—Ç–∞ —Å–º–µ–Ω—ã                             |
| shift_range  | TEXT         | –í—Ä–µ–º—è —Å–º–µ–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "09:00-18:00") |
| hours        | REAL         | –ö–æ–ª-–≤–æ —á–∞—Å–æ–≤ –≤ —Å–º–µ–Ω–µ                   |
| day_note     | TEXT         | –¢–∏–ø –¥–Ω—è: `—Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å`, `–≤—ã—Ö–æ–¥–Ω–æ–π`, `–≥–æ—Å –ø—Ä–∞–∑–¥–Ω–∏–∫`, `–±–æ–ª—å–Ω–∏—á–Ω—ã–π` |

–í—Å–µ –º–µ—Ç–æ–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ Swagger.
